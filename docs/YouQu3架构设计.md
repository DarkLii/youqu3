# YouQu3 架构设计

## 1. 背景

YouQu 是 2021 年成都测试团队开始内部孵化的项目，旨在开发一个简单易用，功能强大的自动化测试框架。经过了 2 年多的持续开发优化，2023 年 8 月正式在 linuxdeepin 社区开源，2024 年 5 月在欧拉社区开源。从开源至今发布了 1.0 和 2.0 两个大版本，小版本更新了上百个。

YouQu 在公司内部已经被大量的自动化测试项目使用，在公司的多个自动化流程中运行得很好，能满足公司对自动化测试的业务需求，也得到了公司领导、同事们、内外部开发者们的认可。

但 YouQu 在现有框架下，仍然存在一些问题，比如：每次使用需要初始化框架工程及单独做环境部署，操作较为复杂、用例开发环境下更新版本不方便、源代码暴露在用户面前，导致框架代码容易被用户拉过去魔改、绑定了太多公司的业务等等。

有些问题处理起来必然会影响到框架的兼容性，势必对现有公司业务流程有一些影响，因此我们才萌生了对框架结构进行重新设计想法，我们想要设计开发一个更加简单易用、更加纯粹、扩展性和兼容性更好的自动化测试框架。

## 2. 目标

YouQu3 旨在成为下一代 Linux 自动化测试框架，在继承 YouQu 诸多亮点功能的同时解决其遇到的问题，同时对各功能进行插件化、模块化改造，全面优化插件调用机制。

- 以 Python 包的形式提供框架能力，方便安装、更新。
- 支持离线部署，用例整体打包交付之后，可以在无网络环境下直接运行。
- 极致轻量化、可定制化依赖，可以根据测试项目类型安装对应的依赖。
- 功能可插拔，以插件的形式提供功能，不安装插件的情况下框架也能正常运行。
- 可视化配置，在浏览器中输入一些配置后即可驱动测试用例执行，搭配远程执行功能，可实现群控测试机执行。
- 支持非开发者下运行，简化系统环境部署。

## 3. 架构设计

### 3.1 总体方案

框架层提供总线服务，各功能以插件的方式接入，功能插件可插拔，由用例层决定使用哪些功能对应安装哪些插件，实现插件依赖的定制化、轻量化。

YouQu3 框架及插件库以 Python 三方包的形式提供，用例层直接 import 使用，框架源代码不直接呈现在用户面前，用户只需要保存用例、方法代码。

框架提供驱动执行的命令，可以在通过命令行快速驱动测试用例执行，通过命令行参数控制，支持多种用例驱动模式，如：路径驱动、标签驱动、关键词驱动等等，执行模式支持本地驱动执行和远程驱动执行。

框架也提供初始化用例工程的功能，一键生成用例工程模板代码，生成的用例工程遵循完整的 PO 设计模式，用例层、方法层基础代码自动生成，资源目录、Git管理、环境依赖等相关功能的目录文件也都一键生成，让用户能专注于用例逻辑的编写和维护。

### 3.2 架构总览

### 3.3 核心流程

### 3.4 详细设计

## 4. 演进规划
